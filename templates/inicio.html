{% extends 'base.html' %}

{% block content %}
<div class="min-h-screen bg-amber-50 flex items-center justify-center px-4 py-12">
  <div class="w-full max-w-3xl bg-white rounded-xl shadow-lg p-6 sm:p-8 text-center">
    <h1 class="text-3xl sm:text-4xl font-bold text-teal-700 mb-4">
      Bienvenido a <span class="text-amber-500">Sunday</span>
    </h1>

    <p class="text-teal-700 text-base sm:text-lg mb-6 leading-relaxed">
      Un espacio pensado para tu bienestar emocional. En Sunday creemos en el poder del cambio, en la esperanza y en la ayuda profesional como herramientas para sanar. Esta app es tu refugio: tranquilo, empático y diseñado para acompañarte en tu proceso.
    </p>

    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 mt-8">
      <a href="{% url 'lista_tests' %}" class="bg-teal-600 text-white px-4 py-3 rounded-md hover:bg-teal-700 transition shadow text-sm sm:text-base">
        Tomar Test
      </a>
      <a href="{% url 'registro' %}" class="bg-teal-600 text-white px-4 py-3 rounded-md hover:bg-teal-700 transition shadow text-sm sm:text-base">
        Diario Emocional
      </a>
      <a href="{% url 'register_emotions' %}" class="bg-teal-600 text-white px-4 py-3 rounded-md hover:bg-teal-700 transition shadow text-sm sm:text-base">
        Registra tus Emociones
      </a>
      <a href="{% url 'chat_page' %}" class="bg-teal-600 text-white px-4 py-3 rounded-md hover:bg-teal-700 transition shadow text-sm sm:text-base">
        Chat
      </a>      
    </div>
  </div>
</div>

<!-- Botón flotante clima (esquina inferior derecha) -->
<div class="fixed bottom-5 right-5 z-50">
  <!-- Botón con ícono de sol -->
  <button onclick="obtenerClima()" class="bg-amber-200 hover:bg-amber-300 text-teal-800 p-3 rounded-full shadow-lg transition">
    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
        d="M12 3v1m0 16v1m8.66-11.34l-.71.71M4.05 19.95l-.71-.71M21 12h-1M4 12H3m16.24 4.95l-.71-.71M6.34 6.34l-.71-.71M16 12a4 4 0 11-8 0 4 4 0 018 0z" />
    </svg>
  </button>

  <!-- Cuadro flotante con clima -->
  <div id="clima" class="hidden mt-2 p-4 bg-white border border-amber-300 rounded-xl shadow-lg w-64">
    <p class="text-center text-sm text-gray-500">Cargando clima...</p>
  </div>
</div>

<script>
  let climaVisible = false;

  function obtenerClima() {
    const climaDiv = document.getElementById('clima');

    if (climaVisible) {
      climaDiv.classList.add('hidden');
      climaVisible = false;
      return;
    }

    climaDiv.classList.remove('hidden');
    climaDiv.innerHTML = '<p class="text-center text-sm text-gray-500">Cargando clima...</p>';
    climaVisible = true;

    if (navigator.geolocation) {
      navigator.geolocation.getCurrentPosition(pos => {
        const lat = pos.coords.latitude;
        const lon = pos.coords.longitude;

        fetch(`/clima/obtener_clima/?lat=${lat}&lon=${lon}`)
          .then(response => response.json())
          .then(data => {
            if (data.error) {
              climaDiv.innerHTML = `<p class="text-red-500 text-center">${data.error}</p>`;
              return;
            }

            const icon_url = `https://openweathermap.org/img/wn/${data.icono}@2x.png`;
            climaDiv.innerHTML = `
              <div class="flex items-center space-x-4">
                <img src="${icon_url}" alt="clima" class="w-14 h-14">
                <div>
                  <p class="text-xl font-semibold text-teal-700">${data.temp}°C</p>
                  <p class="capitalize text-sm text-gray-600">${data.descripcion}</p>
                </div>
              </div>
            `;
          })
          .catch(() => {
            climaDiv.innerHTML = '<p class="text-red-500 text-center">Error al cargar el clima.</p>';
          });
      }, () => {
        climaDiv.innerHTML = '<p class="text-red-500 text-center">Permiso de ubicación denegado.</p>';
      });
    } else {
      climaDiv.innerHTML = '<p class="text-red-500 text-center">Navegador no soporta geolocalización.</p>';
    }
  }
</script>
{% endblock %}
